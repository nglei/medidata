<!doctype html>
<html class="no-js" lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>MediData Blockchain Technology</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="shortcut icon" type="image/png" href="images/icon/favicon.ico">
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <link rel="stylesheet" href="css/font-awesome.min.css">
    <link rel="stylesheet" href="css/themify-icons.css">
    <link rel="stylesheet" href="css/metisMenu.css">
    <link rel="stylesheet" href="css/owl.carousel.min.css">
    <link rel="stylesheet" href="css/slicknav.min.css">
    <!-- amchart css -->
    <link rel="stylesheet" href="https://www.amcharts.com/lib/3/plugins/export/export.css" type="text/css" media="all" />
	<!-- others css -->
    <link rel="stylesheet" href="css/typography.css">
    <link rel="stylesheet" href="css/default-css.css">
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="css/responsive.css">
    <!-- modernizr css -->
    <script src="js/vendor/modernizr-2.8.3.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.6/angular.min.js"></script>
	<script src="https://kit.fontawesome.com/dab481675a.js" crossorigin="anonymous"></script>
</head>

<body ng-app="BlockExplorer">
    <!--[if lt IE 8]>
            <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
        <![endif]-->
    <!-- preloader area start -->
    <div id="preloader">
        <div class="loader"></div>
    </div>
    <!-- preloader area end -->
    <!-- page container area start -->
    <div class="page-container" ng-controller="MainController">
        <!-- sidebar menu area start -->
        <div class="sidebar-menu">
            <div class="sidebar-header">
                <div class="logo">
                    <!--a href="#"><h3>MediData Blockchain Technology</h3></a-->
                </div>
            </div>
            <div class="main-menu">
                <div class="menu-inner">
                    <nav>
                        <ul class="metismenu" id="menu">
                            <li class="active"><a href="#"><i class="ti-home"></i><span>Home</span></a></li>
							<li><a href="contact.html"><i class="ti-user"></i><span>Contact Details</span></a></li>
                            <li><a href="/medicalRecordForD"><i class="fas fa-file-medical"></i><span>Medical Record</span></a></li>
                            <li><a href="prescriptionForD.html"><i class="fas fa-pills"></i> <span>Prescription</span></a></li>
                        </ul>
                    </nav>
                </div>
            </div>
        </div>
        <!-- sidebar menu area end -->
        <!-- main content area start -->
        <div class="main-content">
            <!-- header area start -->
            <div class="header-area">
                <div class="row align-items-center">
                    <!-- nav and search button -->
                    <div class="col-md-6 col-sm-8 clearfix">
                        <div class="nav-btn pull-left">
                            <span></span>
                            <span></span>
                            <span></span>
                        </div>
                        <div class="search-box pull-left">
                            <form action="#">
                                <input type="text" name="search" placeholder="Search..." required>
                                <i class="ti-search"></i>
                            </form>
                        </div>
                    </div>
                    <!-- profile info & task notification -->

                </div>
            </div>
            <!-- header area end -->
            <!-- page title area start -->
            <div class="page-title-area">
                <div class="row align-items-center">
                    <div class="col-sm-6">
                        <div class="breadcrumbs-area clearfix">
                            <h4 class="page-title pull-left">Home</h4>
                        </div>
                    </div>
                    <div class="col-sm-6 clearfix">
                        <div class="user-profile pull-right">
                            <img class="avatar user-thumb" src="images/author/avatar.png" alt="avatar">
                            <h4 class="user-name dropdown-toggle" data-toggle="dropdown">Kumkum Rai <i class="fa fa-angle-down"></i></h4>
                            <div class="dropdown-menu">
                                <a class="dropdown-item" href="#">Message</a>
                                <a class="dropdown-item" href="#">Settings</a>
                                <a class="dropdown-item" href="login.html">Log Out</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- page title area end -->
            <div class="main-content-inner">
				<!-- here -->
				<div class="row">
					<div class="col-xl-6 col-ml-6 col-mdl-4 col-sm-6 mt-5">
                        <div class="card">
                            <div class="card-body">
                                <h4 class="header-title">View Medical Record</h4>
                                <div class="exhcange-rate mt-5">
                                    <form ng-submit="search(searchValue)">
										                            <div class="input-group">
											                              <div class="input-group-prepend">
												                               <span class="input-group-text" id="basic-addon3">Public Key</span>
											                              </div>
											                              <input type="text" class="form-control" id="pkeyMedicalRecord" placeholder="Enter Public Key" aria-describedby="basic-addon3" ng-model="searchValue">
										                             </div>
                                                 <div class="form-group">
          						                                   <select class="form-control" ng-model="searchType">
          							                                          <option value="block">Block Hash</option>
          							                                          <option value="address">Address</option>
          						                                   </select>
          					                             </div>
                                                 <div class="pkey">
											                               <button type="submit" class="btn btn-lg btn-primary mb-3">Get Medical Record List</button>
                                                </div>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
					<div class="col-xl-6 col-ml-6 col-mdl-4 col-sm-6 mt-5">
                        <div class="card">
                            <div class="card-body">
                                <h4 class="header-title">View Prescription</h4>
                                <div class="exhcange-rate mt-5">
                                    <form action="prescriptionForD.html">
										<div class="input-group">
											<div class="input-group-prepend">
												<span class="input-group-text" id="basic-addon3">Public Key</span>
											</div>
											<input type="text" class="form-control" id="pKeyPrescription" placeholder="Enter Public Key" aria-describedby="basic-addon3">
										</div>
                                        <div class="pkey">
											<button type="submit" class="btn btn-lg btn-primary mb-3">Get Prescription List</button>
                                        </div>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>

				</div>
        <table class="dbkit-table medical" ng-if="addressData">

          <thead>
            <tr class="heading-td">
            <th scope="col">Doctor Assigned</th>
            <th scope="col">Assigned Hospital</th>
            <th scope="col">Reference</th>
            <th scope="col">Title</th>
            <th scope="col">ID</th>
           </tr>
                <!--tr class="heading-td">
                    <td class="tNo">NO.</td>
                    <td>Date</td>
                    <td>Reference NO.</td>
                    <td>Title</td>
                    <td>Doctor Assigned</td>
                    <td>Assigned Hospital</td>
                </tr-->
              </thead>
                <tbody>
                <tr ng-repeat="transaction in addressData.addressTransactions" >
                    <td class="tNo">1</td>
                    <td>{{ transaction.recipient }}</td>
                    <td>{{ transaction.sender }}</td>
                    <td>{{ transaction.amount }}</td>
                    <td>Dr. Lim</td>
                    <td>Hospital HELP</td>
                </tr>
              </tbody>
              </table>
        <table class="dbkit-table medical" ng-if="addressData">
					<thead>
								<tr class="heading-td">
										<td class="tNo">NO.</td>
										<td>Date</td>
										<td>Reference NO.</td>
										<td>Title</td>
										<td>Doctor Assigned</td>
										<td>Assigned Hospital</td>
								</tr></thead>
								<tbody>
								<tr onclick="location.href='viewMedicalRecord.html';">
										<td class="tNo">1</td>
										<td>{{ transaction.recipient }}</td>
										<td>{{ transaction.sender }}</td>
										<td>{{ transaction.amount }}</td>
										<td>Dr. Lim</td>
										<td>Hospital HELP</td>
								</tr>
							</tbody>
							</table>
					<!-- here -->
            </div>
        </div>
        <!-- main content area end -->
        <!-- footer area start-->
        <footer>
            <div class="footer-area">
                <p>© Copyright 2018. All right reserved. Template by <a href="https://colorlib.com/wp/">Colorlib</a>.</p>
            </div>
        </footer>
        <!-- footer area end-->
    </div>
    <!-- page container area end -->
    <!-- offset area start -->

    <!-- offset area end -->
    <!-- jquery latest version -->
    <script src="js/vendor/jquery-2.2.4.min.js"></script>
    <!-- bootstrap 4 js -->
    <script src="js/popper.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/owl.carousel.min.js"></script>
    <script src="js/metisMenu.min.js"></script>
    <script src="js/jquery.slimscroll.min.js"></script>
    <script src="js/jquery.slicknav.min.js"></script>

    <!-- start chart js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.2/Chart.min.js"></script>
    <!-- start highcharts js -->
    <script src="https://code.highcharts.com/highcharts.js"></script>
    <!-- start zingchart js -->
    <script src="https://cdn.zingchart.com/zingchart.min.js"></script>
    <script>
    zingchart.MODULESDIR = "https://cdn.zingchart.com/modules/";
    ZC.LICENSE = ["569d52cefae586f634c54f86dc99e6a9", "ee6b7db5b51705a13dc2339db3edaf6d"];
    </script>
    <!-- all line chart activation -->
    <script src="js/line-chart.js"></script>
    <!-- all bar chart activation -->
    <script src="js/bar-chart.js"></script>
    <!-- all pie chart -->
    <script src="js/pie-chart.js"></script>
    <!-- others plugins -->
    <script src="js/plugins.js"></script>
    <script src="js/scripts.js"></script>

    <script>
  		window.app = angular.module('BlockExplorer', []);

  		app.controller('MainController', function($scope, $http) {
  			$scope.block = null;
  			$scope.transaction = null;
  			$scope.addressData = null;
  			$scope.initialSearchMade = false;

  			$scope.fetchBlock = function(blockHash) {
  				$http.get(`/block/${blockHash}`)
  				.then(response => {
  					$scope.block = response.data.block;
  					$scope.transaction = null;
  					$scope.addressData = null;
  				});
  			};

  			$scope.fetchTransaction = function(transactionId) {
  				$http.get(`/transaction/${transactionId}`)
  				.then(response => {
  					$scope.transaction = response.data.transaction;
  					$scope.block = null;
  					$scope.addressData = null;
  				});
  			};

  			$scope.fetchAddressData = function(address) {
  				$http.get(`/address/${address}`)
  				.then(response => {
  					$scope.addressData = response.data.addressData;
  					if (!$scope.addressData.addressTransactions.length) $scope
  						.addressData = null;
  					$scope.block = null;
  					$scope.transaction = null;
  				});
  			};

  			$scope.search = function(searchValue) {
  				$scope.initialSearchMade = true;
  				if ($scope.searchType === 'block') {
  					$scope.fetchBlock(searchValue);
  				}
  				else if ($scope.searchType === 'transaction') {
  					$scope.fetchTransaction(searchValue);
  				}
  				else if ($scope.searchType === 'address') {
  					$scope.fetchAddressData(searchValue);
  				}
  			};

  		});
  	</script>
</body>

</html>
